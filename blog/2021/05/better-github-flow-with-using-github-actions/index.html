<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://salimkayabasi.com/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://salimkayabasi.com/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://salimkayabasi.com/main.6a61cba925aa876029bace6d02e35d599ca6a5cf49522f6bdbd489cc125e73b5f11f34a81e1beda53002e1c795a61809e43de087ffa7998449badd2c0479e924.css integrity="sha512-amHLqSWqh2Apus5tAuNdWZympc9JUi9r29SJzBJec7XxHzSoHhvtpTAC4ceVphgJ5D3gh/+nmYRJut0sBHnpJA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Better GitHub flow with using GitHub Actions - Salim KAYABASI</title><meta name=description content="Empowering team members to archive collaborative goals. Always aiming for team success. Experienced on engineering and a great team player with a demonstrated history of working in the transportation/ride hailing/car-sharing industry."><link rel=canonical href=https://salimkayabasi.com/blog/2021/05/better-github-flow-with-using-github-actions/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/doks.png"><meta name=twitter:title content="Better GitHub flow with using GitHub Actions"><meta name=twitter:description content="taken from GitHub flow documentation  I would like to optimize the Deploy step of GitHub flow but before reading further, it might be better to check GitHub flow.
Depending on team requirements and decision, deployment step can be on pull request level or maybe after merging it to HEAD branch. Most of the client-first projects; mobile apps, single page apps and similar other projects can be deployed/published as a temproary state."><meta name=twitter:site content="@salimkayabasi"><meta name=twitter:creator content="@salimkayabasi"><meta property="og:title" content="Better GitHub flow with using GitHub Actions"><meta property="og:description" content="taken from GitHub flow documentation  I would like to optimize the Deploy step of GitHub flow but before reading further, it might be better to check GitHub flow.
Depending on team requirements and decision, deployment step can be on pull request level or maybe after merging it to HEAD branch. Most of the client-first projects; mobile apps, single page apps and similar other projects can be deployed/published as a temproary state."><meta property="og:type" content="article"><meta property="og:url" content="/blog/2021/05/better-github-flow-with-using-github-actions/"><meta property="og:image" content="/doks.png"><meta property="article:published_time" content="2021-05-21T11:24:20+00:00"><meta property="article:modified_time" content="2021-05-21T11:24:20+00:00"><meta property="og:site_name" content="Salim KAYABASI"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"\/blog\/2021\/05\/better-github-flow-with-using-github-actions\/"},"headline":"Better GitHub flow with using GitHub Actions","image":[],"datePublished":"2021-05-21T11:24:20CET","dateModified":"2021-05-21T11:24:20CET","author":{"@type":"Person","name":"Salim KAYABASI"},"publisher":{"@type":"Person","name":"Salim KAYABASI"},"description":""}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/salimkayabasi.com\/"},{"@type":"ListItem","position":3,"name":"Blog","item":"https:\/\/salimkayabasi.com\/\/blog\/"},{"@type":"ListItem","position":4,"name":"2021st","item":"https:\/\/salimkayabasi.com\/\/blog\/2021\/"},{"@type":"ListItem","position":5,"name":"5th","item":"https:\/\/salimkayabasi.com\/\/blog\/2021\/05\/"},{"@type":"ListItem","position":6,"name":"Better Github Flow With Using Github Actions","item":"https:\/\/salimkayabasi.com\/\/blog\/2021\/05\/better-github-flow-with-using-github-actions\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon-precomposed sizes=57x57 href=https://salimkayabasi.com/favicons/apple-touch-icon-57x57.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=https://salimkayabasi.com/favicons/apple-touch-icon-114x114.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=https://salimkayabasi.com/favicons/apple-touch-icon-72x72.png><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://salimkayabasi.com/favicons/apple-touch-icon-144x144.png><link rel=apple-touch-icon-precomposed sizes=60x60 href=https://salimkayabasi.com/favicons/apple-touch-icon-60x60.png><link rel=apple-touch-icon-precomposed sizes=120x120 href=https://salimkayabasi.com/favicons/apple-touch-icon-120x120.png><link rel=apple-touch-icon-precomposed sizes=76x76 href=https://salimkayabasi.com/favicons/apple-touch-icon-76x76.png><link rel=apple-touch-icon-precomposed sizes=152x152 href=https://salimkayabasi.com/favicons/apple-touch-icon-152x152.png><link rel=icon type=image/png href=https://salimkayabasi.com/favicons/favicon-196x196.png sizes=196x196><link rel=icon type=image/png href=https://salimkayabasi.com/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=https://salimkayabasi.com/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://salimkayabasi.com/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=https://salimkayabasi.com/favicons/favicon-128.png sizes=128x128><meta name=application-name content="&nbsp;"><meta name=msapplication-TileColor content="#FFFFFF"><meta name=msapplication-TileImage content="https://salimkayabasi.com/favicons/mstile-144x144.png"><meta name=msapplication-square70x70logo content="https://salimkayabasi.com/favicons/mstile-70x70.png"><meta name=msapplication-square150x150logo content="https://salimkayabasi.com/favicons/mstile-150x150.png"><meta name=msapplication-wide310x150logo content="https://salimkayabasi.com/favicons/mstile-310x150.png"><meta name=msapplication-square310x310logo content="https://salimkayabasi.com/favicons/mstile-310x310.png"><link rel=manifest href=https://salimkayabasi.com/site.webmanifest></head><body class="blog single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 me-auto" href=https://salimkayabasi.com/>Salim KAYABASI</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link target=_blank href=https://github.com/salimkayabasi><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li><li class=nav-item><a class=nav-link target=_blank href=https://twitter.com/salimkayabasi><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><span class="ms-2 visually-hidden">Twitter</span></a></li><li class=nav-item><a class=nav-link target=_blank href=https://www.linkedin.com/in/salimkayabasi><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg><span class="ms-2 visually-hidden">Linkedin</span></a></li><li class=nav-item><a class=nav-link target=_blank href=https://www.youtube.com/user/salimkayabasi><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-youtube"><path d="M22.54 6.42a2.78 2.78.0 00-1.94-2C18.88 4 12 4 12 4s-6.88.0-8.6.46a2.78 2.78.0 00-1.94 2A29 29 0 001 11.75a29 29 0 00.46 5.33A2.78 2.78.0 003.4 19c1.72.46 8.6.46 8.6.46s6.88.0 8.6-.46a2.78 2.78.0 001.94-2 29 29 0 00.46-5.25 29 29 0 00-.46-5.33z"/><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/></svg><span class="ms-2 visually-hidden">Youtube</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://salimkayabasi.com/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=https://salimkayabasi.com/projects/>Projects</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search in blog posts" aria-label=Search... autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row justify-content-center"><div class=col-12><article><div class=blog-header><h1>Better GitHub flow with using GitHub Actions</h1><p><small>Posted May 21, 2021 &nbsp;&dash;&nbsp;<strong>3&nbsp;min read</strong></small><p></div><p class="lead text-center">GitHub flow is already lightweight and easy to understand but we can make it better with using GitHub Actions.
Let's have a look on how to deploy from a single branch to multiple environments in a secure way.</p><figure class="figure w-100"><img src=./assets/flow-deploy.png class="w-100 figure-img img-fluid rounded"><figcaption class="figure-caption text-center">taken from GitHub flow documentation</figcaption></figure><p>I would like to optimize the <code>Deploy</code> step of GitHub flow but before reading further, it might be better to check <a href=https://guides.github.com/introduction/flow/>GitHub flow</a>.</p><p>Depending on team requirements and decision, deployment step can be on <code>pull request</code> level or maybe after merging it to <code>HEAD</code> branch.
Most of the client-first projects; mobile apps, single page apps and similar other projects can be deployed/published as a temproary state.
Those temprorary deployments can be removed after merging the pull requests. But for the backend application, it would be easy solution to deploy them directly to target environment and test it there after merging pull requests.</p><h2 id=beauty-of-github-actions>Beauty of GitHub Actions?</h2><p>GitHub flow doesn&rsquo;t mention about anything related to release branches or tags or any other alternatives for deploying multiple environments on same repository.
As we all know, we need at least two different environments. One for development env to see the latest changes with high frequency of deployments.
Another one called production env for our users to access it.</p><p>Some teams would prefer to have protected branches for each environments. It may help you to see what was deployed to which environment.
As an idea, I don&rsquo;t prefer to use git as deployment tracking tool.</p><p>GitHub is offering <a href=https://docs.github.com/en/actions/reference/environments>Environment</a> out of the box and it can be integrated with GitHub Actions.
It is possible to configure deployment steps to deploy spesific environment when conditions are met.</p><figure class="figure w-100"><img src=./assets/envs.png class="w-100 figure-img img-fluid rounded"><figcaption class="figure-caption text-center">Multiple environments have been created</figcaption></figure><p>Just a single click to create a new environment and start defining conditions for deploying to given environment.</p><figure class="figure w-100"><img src=./assets/env-review.png class="w-100 figure-img img-fluid rounded"><figcaption class="figure-caption text-center">Review can be required to deploy</figcaption></figure><p>As we can define branch protection, it is also possible to protect deployments. We can force to be reviewed before deployment.
And also it is possible to limit the branches which are allowed to deploy anything. Actual piece of this feature is having environment based secrets.</p><p>Secrets can be organization level, repository level or even environment level too. So we can use different deployment secrets on different environments.</p><figure class="figure w-100"><img src=./assets/env-protection.png class="w-100 figure-img img-fluid rounded"><figcaption class="figure-caption text-center">Protection of given environment</figcaption></figure><h2 id=flow-in-action>Flow in Action</h2><p>It is still an option to have multiple protected branches on GitHub and track your deployments. But having one step further is always better.
We can now protect who can deploy to which environments. We can have different deployment secrets for each deployments.</p><p>In order to do that, just define the <code>environment</code> and <code>name</code> in your action file. The name should match with the ones under settings of repository.
GitHub will create a new one if the given name is not created previously.</p><p>Real life example from my current team;</p><ul><li>We are having single branch called <code>main</code> and merge all pull requests after reviews.</li><li><code>main</code> branch deploys on every push to <code>Development</code> environment.</li><li>We&rsquo;ve also defined manual triggers for deployments where we can set target environment.</li><li>Once all the integration tests are green on <code>Development</code> environment, we are good to go for <code>Production</code> deployment by just triggering it.</li><li>Reviewer checks and approves for deployment</li><li>Deployment starts</li></ul><div class=highlight><pre style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=color:#4e4e4e># .github/workflows/deploy.yml</span>
<span style=color:#0087ff>name</span>: Deploy

<span style=color:#0087ff>on</span>:
  <span style=color:#0087ff>workflow_dispatch</span>:
    <span style=color:#0087ff>inputs</span>:
      <span style=color:#0087ff>environment</span>:
        <span style=color:#0087ff>description</span>: <span style=color:#00afaf>&#39;Name of environment to deploy&#39;</span>
        <span style=color:#0087ff>required</span>: <span style=color:#d75f00>true</span>
        <span style=color:#0087ff>default</span>: <span style=color:#00afaf>&#39;Staging&#39;</span>
  <span style=color:#0087ff>push</span>:
    <span style=color:#0087ff>branches</span>:
      - main
<span style=color:#0087ff>jobs</span>:
  <span style=color:#4e4e4e># .... some other previous jobs</span>
  <span style=color:#0087ff>deploy</span>:
    <span style=color:#0087ff>name</span>: Deploy
    <span style=color:#0087ff>runs-on</span>: ubuntu-latest
    <span style=color:#0087ff>if</span>: github.ref == &#39;refs/heads/main&#39;
    <span style=color:#0087ff>environment</span>:
      <span style=color:#0087ff>name</span>: Production <span style=color:#4e4e4e># can be defined dynamicly</span>
      <span style=color:#0087ff>url</span>: https://url-of-production
</code></pre></div><h2 id=summary>Summary</h2><p>GitHub Flow is already simple and easy to understand but now it is powerful and secure also.
It is nice to see what was deployed by who and when. We can defined protection rules and set secrets per environments.
As an example, you can have a look on deployment of this blog page, by clicking <a href=https://github.com/salimkayabasi/salimkayabasi.com/deployments>here</a>.</p></article></div></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Any questions or feedback,</br>please feel free to share them with me</br><a target=_blank href=https://twitter.com/salimkayabasi>@salimkayabasi</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://salimkayabasi.com/js/highlight.min.870b98c6e2a30c54a909ac6ca7f8303a3f01a323cb8e46b4660552fd943345e29e9ba1023024ee64e5b3c7fe80835c51c78cb60e850a2f0271f486d4fde39a78.js integrity="sha512-hwuYxuKjDFSpCaxsp/gwOj8BoyPLjka0ZgVS/ZQzReKem6ECMCTuZOWzx/6Ag1xRx4y2DoUKLwJx9IbU/eOaeA==" crossorigin=anonymous defer></script><script src=https://salimkayabasi.com/main.min.cb1cfa565384689404329cbf8ad4a175b59ac6421a528ad947882d8242fc7b62b773cd5967a10349256154f6a67bcdeeb3da0729191ddd4f5623442999e53004.js integrity="sha512-yxz6VlOEaJQEMpy/itShdbWaxkIaUorZR4gtgkL8e2K3c81ZZ6EDSSVhVPame83us9oHKRkd3U9WI0QpmeUwBA==" crossorigin=anonymous defer></script><script src=https://salimkayabasi.com/index.min.b0ce301e7520fc851675f4fa30cf8d562718c5f146a86693754e75d0e10fa2eddf20c865a4940f4fbc034702eb67cc7d06e6210c71c396341d6e02f7e56434a9.js integrity="sha512-sM4wHnUg/IUWdfT6MM+NVicYxfFGqGaTdU510OEPou3fIMhlpJQPT7wDRwLrZ8x9BuYhDHHDljQdbgL35WQ0qQ==" crossorigin=anonymous defer></script></body></html>